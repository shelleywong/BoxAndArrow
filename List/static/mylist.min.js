var av,l,head,statusElement=document.getElementById("status"),progressElement=document.getElementById("progress"),spinnerElement=document.getElementById("spinner"),Module={preRun:[],postRun:[],print:function(){var t=document.getElementById("output");return t&&(t.value=""),function(e){1<arguments.length&&(e=Array.prototype.slice.call(arguments).join(" ")),console.log(e),t&&(t.value+=e+"\n",t.scrollTop=t.scrollHeight)}}(),printErr:function(e){1<arguments.length&&(e=Array.prototype.slice.call(arguments).join(" ")),console.error(e)},canvas:function(){var e=document.getElementById("canvas");return e.addEventListener("webglcontextlost",function(e){alert("WebGL context lost. You will need to reload the page."),e.preventDefault()},!1),e}(),setStatus:function(e){var t,n;Module.setStatus.last||(Module.setStatus.last={time:Date.now(),text:""}),e!==Module.setStatus.last.text&&(t=e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),n=Date.now(),t&&n-Module.setStatus.last.time<30||(Module.setStatus.last.time=n,Module.setStatus.last.text=e,t?(e=t[1],progressElement.value=100*parseInt(t[2]),progressElement.max=100*parseInt(t[4]),progressElement.hidden=!1,spinnerElement.hidden=!1):(progressElement.value=null,progressElement.max=null,progressElement.hidden=!0,e||(spinnerElement.hidden=!0)),statusElement.innerHTML=e))},totalDependencies:0,monitorRunDependencies:function(e){this.totalDependencies=Math.max(this.totalDependencies,e),Module.setStatus(e?"Preparing... ("+(this.totalDependencies-e)+"/"+this.totalDependencies+")":"All downloads complete.")}};function insertHead(e,t){av.umsg("Testing List::insert() at head for value: "+t),av.step(),e.insert(t),l.addFirst(t),1==l.size()?(av.step(),av.umsg("head pointer points to first element in the list"),head=av.pointer("head",l.get(0))):head.target(l.get(0)),l.layout(),av.step()}function insertEnd(e,t){av.umsg("Testing List::insert_at_end() for value "+t),av.step(),e.insert_at_end(t)?(av.umsg("Insert "+t+" at the end of the list"),-1==(e=e.length()-1)?(av.step(),av.umsg(t+" should've been inserted into the list, but something went wrong")):(l.add(e,t),1==l.size()&&(av.step(),av.umsg("head pointer points to first element in the list"),head=av.pointer("head",l.get(0))),l.layout())):av.umsg(t+" is already in the list"),av.step()}function findLength(e){av.umsg("Testing List::length()"),av.step();var n=e.length();for(let t=0;t<n;t++){let e=l.get(t);e.highlight(),av.umsg("Count = "+(t+1)),av.step(),e.unhighlight()}av.umsg("The length of the linked list is "+n)}function printList(e){av.umsg("Testing List::print()"),av.step(),e.print(),0==e.length()?av.umsg("Your linked list was empty, so nothing printed."):av.umsg("Check the stdout results from your C++ implementation (shown in the box below)")}function lookupVal(e,n){av.umsg("Testing List::lookup() for value "+n);var a=e.lookup(n);if(av.step(),-1==a)av.umsg(n+" is not in the list."),av.step();else{let t=0;for(;t!=a;){let e=l.get(t);e.highlight(),av.umsg("target not found at list node "+t),av.step(),e.unhighlight(),t++}av.umsg("target "+n+" found at node "+a);let e=l.get(a);e.css({"background-color":"rgb(140, 35, 50)",color:"white"}),av.step(),e.css({"background-color":"white",color:"black"}),l.layout()}}function removeVal(a,s){av.umsg("Testing List::remove() for value "+s);var o=a.remove(s);if(av.step(),-1==o)av.umsg(s+" is not in the list and cannot be removed."),av.step();else{let t=0;for(;t!=o;){let e=l.get(t);e.highlight(),av.umsg("target not found at node "+t+" in the list"),av.step(),e.unhighlight(),t++}let e=l.get(o);e.highlight(),av.umsg("target "+s+" was found"),av.step();let n=l.remove(o);av.umsg(n.value()+" was removed"),0==o&&(0<a.length()?(head.target(l.get(0)),av.step(),av.umsg("head pointer now points to "+l.get(0).value())):(av.step(),av.umsg("List is now empty"))),l.layout(),av.step()}}function removeHead(n){av.umsg("Testing List::remove_head()");var e=n.remove_head();if(av.step(),0==e)av.umsg("List was empty so there was nothing to be removed"),av.step();else{let e=l.get(0);e.highlight(),av.umsg("Removing "+e.value()+" from list head"),av.step();let t=l.remove(0);av.umsg(t.value()+" was removed"),0<n.length()?(head.target(l.get(0)),av.step(),av.umsg("head pointer now points to "+l.get(0).value())):(av.step(),av.umsg("List is now empty")),l.layout(),av.step()}}function callCommand(t,n,a,s){for(let e=0;e<s;e++){var l=n[e];if(Number.isInteger(l)){switch(a){case"insert":insertHead(t,l);break;case"insert_at_end":insertEnd(t,l);break;case"length":findLength(t);break;case"print":printList(t);break;case"lookup":lookupVal(t,l);break;case"remove":removeVal(t,l);break;case"remove_head":removeHead(t);break;default:av.umsg("Invalid Command")}t.print()}else av.umsg("The value "+l+" is invalid")}}function createAndCall(e,t,n,a){var s=document.getElementById(t).innerHTML;let l=document.getElementById(n).innerHTML;t=l.split(",").map(Number),n=t.length;av.umsg("Command #"+a+": "+s),callCommand(e,t,s,n),av.step()}Module.setStatus("Downloading..."),window.onerror=function(){Module.setStatus("Exception thrown, see JavaScript console"),spinnerElement.style.display="none",Module.setStatus=function(e){e&&Module.printErr("[post-exception status] "+e)}},av=new JSAV("container"),document.querySelector(".restart").addEventListener("click",function(){location.replace("list")}),document.querySelector(".startlist").addEventListener("click",function(){$(this).prop("disabled",!0),l=av.ds.list();var e=new Module.List;av.umsg("We'll run the visualization using your list commands"),av.step(),av.displayInit(),createAndCall(e,"name1","array1vals",1),createAndCall(e,"name2","array2vals",2),createAndCall(e,"name3","array3vals",3),av.umsg("Did your linked list work as expected?"),av.step(),e.delete(),av.recorded()});